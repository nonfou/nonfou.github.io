var nextPage=2,loading=!1,postsPerPage=$(".post-entry").length,allPagesFetched=!1,loadingHTML='<div class="loading"><div class="spinner"><div></div><div></div><div></div></div></div>';loading=!1;function startLoading(){loading=!0,$(".entries").parent().append(loadingHTML)}function stopLoading(){loading=!1,$(".loading")&&$(".loading").remove()}function isLoading(){return loading}function appendPage(){allPagesFetched||isLoading()||(startLoading(),$.get("/page/"+nextPage+"/").fail((function(){allPagesFetched=!0})).done((function(n){nextPage+=1;var e=$("<div/>").html(n).contents().find(".post-entry");$(".entries").append(e),e.length<postsPerPage&&(allPagesFetched=!0)})).always((function(){stopLoading()})))}$(window).scroll((function(){$(window).scrollTop()>=$(document).height()-$(window).height()-16&&appendPage()}));