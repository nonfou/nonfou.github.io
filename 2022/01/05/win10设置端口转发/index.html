<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=" id=&quot;Win10设置端口转发&quot;&gt;&lt;a href=&quot;#Win10设置端口转发&quot; class=&quot;headerlink&quot; title=&quot;Win10设置端口转发&quot;&gt;&lt;/a&gt;Win10设置端口转发&lt;/h2&gt;&lt;h3 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h3&gt;&lt;p&gt;        在Win10 wsl系统（ip: 192.168.230.20）中启动了一个服务A，暴露出一个端口：3000，我在本机（ip：172.16.20.166）上访问，即：&lt;a href=&quot;http://192.168.230.20:3000/&quot;&gt;http://192.168.230.20:3000&lt;/a&gt; 没有问题，如果局域网中的其它电脑想要访问服务A，是访问不到的。"><link rel="stylesheet" href="/css/normalize.css"><link rel="stylesheet" href="/css/highlight.css"><link rel="stylesheet" href="/css/noise.css"><title>win10设置端口转发 | 徐冲的草稿本</title><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><meta name="generator" content="Hexo 5.4.0"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Archives</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-none-link" href="/tags/win10/" rel="tag">win10</a></div><div class="post-time">2022-01-05</div></div></div><div class="container post-header"><h1>win10设置端口转发</h1></div><div class="container post-toc"><details class="toc"><summary class="toc-accordion">Table of Contents</summary><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Win10%E8%AE%BE%E7%BD%AE%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91"><span class="toc-number">1.</span> <span class="toc-text">Win10设置端口转发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%83%8C%E6%99%AF"><span class="toc-number">1.1.</span> <span class="toc-text">背景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">1.2.</span> <span class="toc-text">解决方案</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Win10%E9%85%8D%E7%BD%AE%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91"><span class="toc-number">1.2.0.0.1.</span> <span class="toc-text">Win10配置端口转发</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E5%8F%82%E8%80%83"><span class="toc-number">1.2.0.0.2.</span> <span class="toc-text">命令参考</span></a></li></ol></li></ol></li></ol></details></div><div class="container post-content"><h2 id="Win10设置端口转发"><a href="#Win10设置端口转发" class="headerlink" title="Win10设置端口转发"></a>Win10设置端口转发</h2><h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>        在Win10 wsl系统（ip: 192.168.230.20）中启动了一个服务A，暴露出一个端口：3000，我在本机（ip：172.16.20.166）上访问，即：<a target="_blank" rel="noopener" href="http://192.168.230.20:3000/">http://192.168.230.20:3000</a> 没有问题，如果局域网中的其它电脑想要访问服务A，是访问不到的。</p><h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><p>        如果局域网中的其它电脑需要访问本机wsl中启动的服务，则需要设置Win10的端口转发，将访问本机的端口转发到本机内部的wsl系统中</p><ol><li><p>利用Nginx做端口转发</p></li><li><p>利用Win10配置端口转发</p></li></ol><h6 id="Win10配置端口转发"><a href="#Win10配置端口转发" class="headerlink" title="Win10配置端口转发"></a>Win10配置端口转发</h6><p>管理员运行</p><ol><li><p>配置端口转发</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># win10监听端口3000，转发到wsl（192.168.23.20）上的端口3000</span></span><br><span class="line">netsh interface portproxy add v4tov4 listenport=3000 connectport=3000 connectaddress=192.168.230.20</span><br></pre></td></tr></table></figure></li><li><p>配置防火墙规则</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 放行端口3000</span></span><br><span class="line">New-NetFirewallRule -DisplayName <span class="string">&quot;Allow Inbound TCP Port 3000&quot;</span> -Direction Inbound -Action Allow -Protocol TCP -LocalPort 3000</span><br></pre></td></tr></table></figure></li></ol><h6 id="命令参考"><a href="#命令参考" class="headerlink" title="命令参考"></a>命令参考</h6><ol><li><p>查看转发规则</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh interface portproxy show v4tov4</span><br></pre></td></tr></table></figure></li><li><p>删除端口转发规则</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh interface portproxy delete v4tov4 listenport=3000</span><br></pre></td></tr></table></figure></li><li><p>重置端口转发规则</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh interface portproxy reset</span><br></pre></td></tr></table></figure></li><li><p>删除防火墙规则</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Remove-NetFirewallRule -DisplayName <span class="string">&quot;Allow Inbound TCP Port 3000&quot;</span></span><br></pre></td></tr></table></figure></li></ol><p>博客参考</p><p>        <a target="_blank" rel="noopener" href="https://logi.im/script/achieving-access-to-files-and-resources-on-the-network-between-win10-and-wsl2.html#:~:text=Win10%20%E6%89%80%E5%9C%A8%E5%B1%80%E5%9F%9F%E7%BD%91%E8%AE%BE%E5%A4%87%E8%AE%BF%E9%97%AE%20WSL2%20%E9%A6%96%E5%85%88%E9%9C%80%E8%A6%81%E7%A1%AE%E4%BF%9D%20Windows%20%E5%8F%AF%E4%BB%A5%E8%AE%BF%E9%97%AE%20WSL2%EF%BC%8C%E6%8E%A5%E7%9D%80%E5%9C%A8%20Windows,%E9%98%B2%E7%81%AB%E5%A2%99%E5%85%A5%E7%AB%99%20%E8%A7%84%E5%88%99%EF%BC%8C%E5%B0%86%E8%AF%B7%E6%B1%82%E8%BD%AC%E5%8F%91%E5%88%B0%20WSL2%E3%80%82%20%E4%BB%A5%E4%B8%8B%E4%B8%BA%20Powershell%20%E5%91%BD%E4%BB%A4%EF%BC%8C%E9%9C%80%20%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90%20%E6%89%A7%E8%A1%8C%E3%80%82">Win10 与 WSL2 间的网络和文件互访 - LOGI</a></p></div></div><div class="post-main post-comment"></div></article><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function(){$(".fancybox").fancybox()})</script></body></html>