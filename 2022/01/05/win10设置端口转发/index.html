<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>win10设置端口转发 [ 徐冲的草稿本 ]</title><link rel="icon" href="/img/favicon.ico"><meta name="author" content="Chong Xu"><link rel="alternate" href="/atom.xml" title="徐冲的草稿本" type="application/atom+xml"><link rel="stylesheet" href="/css/main.css"><meta name="generator" content="Hexo 6.2.0"></head><body data-theme="light" class="notransition"><script>const body=document.body,data=body.getAttribute("data-theme"),initTheme=t=>{"dark"===t?body.setAttribute("data-theme","dark"):"light"===t?body.removeAttribute("data-theme"):localStorage.setItem("theme",data)};initTheme(localStorage.getItem("theme")),setTimeout(()=>body.classList.remove("notransition"),75)</script><div class="navbar" role="navigation"><nav class="menu"><input type="checkbox" id="menu-trigger" class="menu-trigger"> <label for="menu-trigger"><span class="menu-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512"><path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z"/></svg></span></label> <a id="mode"><svg class="mode-sunny" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512"><title>LIGHT</title><line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/></svg> <svg class="mode-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512"><title>DARK</title><line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/></svg></a><div class="trigger"><div class="trigger-container"><a class="menu-link" href="/">Home</a> <a class="menu-link" href="/about/">About</a> <a class="menu-link" href="/archives/">Archives</a> <a class="menu-link" href="/tags/">Tags</a></div></div></nav></div><div class="wrapper post"><main class="page-content" aria-label="Content"><header class="header"><div class="tags"><a href="/tags/win10/" class="tag"># win10</a></div><h1 class="header-title" itemprop="headline">win10设置端口转发</h1><div class="post-meta"><time>1月 05, 2022</time> <span itemprop="author"><span itemprop="name">Chong Xu</span></span></div></header><div class="page-content"><h2 id="Win10设置端口转发"><a href="#Win10设置端口转发" class="headerlink" title="Win10设置端口转发"></a>Win10设置端口转发</h2><h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>        在Win10 wsl系统（ip: 192.168.230.20）中启动了一个服务A，暴露出一个端口：3000，我在本机（ip：172.16.20.166）上访问，即：<a target="_blank" rel="noopener" href="http://192.168.230.20:3000/">http://192.168.230.20:3000</a> 没有问题，如果局域网中的其它电脑想要访问服务A，是访问不到的。</p><h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><p>        如果局域网中的其它电脑需要访问本机wsl中启动的服务，则需要设置Win10的端口转发，将访问本机的端口转发到本机内部的wsl系统中</p><ol><li><p>利用Nginx做端口转发</p></li><li><p>利用Win10配置端口转发</p></li></ol><h6 id="Win10配置端口转发"><a href="#Win10配置端口转发" class="headerlink" title="Win10配置端口转发"></a>Win10配置端口转发</h6><p>管理员运行</p><ol><li><p>配置端口转发</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># win10监听端口3000，转发到wsl（192.168.23.20）上的端口3000</span></span><br><span class="line">netsh interface portproxy add v4tov4 listenport=3000 connectport=3000 connectaddress=192.168.230.20</span><br></pre></td></tr></table></figure></li><li><p>配置防火墙规则</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 放行端口3000</span></span><br><span class="line">New-NetFirewallRule -DisplayName <span class="string">&quot;Allow Inbound TCP Port 3000&quot;</span> -Direction Inbound -Action Allow -Protocol TCP -LocalPort 3000</span><br></pre></td></tr></table></figure></li></ol><h6 id="命令参考"><a href="#命令参考" class="headerlink" title="命令参考"></a>命令参考</h6><ol><li><p>查看转发规则</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh interface portproxy show v4tov4</span><br></pre></td></tr></table></figure></li><li><p>删除端口转发规则</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh interface portproxy delete v4tov4 listenport=3000</span><br></pre></td></tr></table></figure></li><li><p>重置端口转发规则</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh interface portproxy reset</span><br></pre></td></tr></table></figure></li><li><p>删除防火墙规则</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Remove-NetFirewallRule -DisplayName <span class="string">&quot;Allow Inbound TCP Port 3000&quot;</span></span><br></pre></td></tr></table></figure></li></ol><p>博客参考</p><p>        <a target="_blank" rel="noopener" href="https://logi.im/script/achieving-access-to-files-and-resources-on-the-network-between-win10-and-wsl2.html#:~:text=Win10%20%E6%89%80%E5%9C%A8%E5%B1%80%E5%9F%9F%E7%BD%91%E8%AE%BE%E5%A4%87%E8%AE%BF%E9%97%AE%20WSL2%20%E9%A6%96%E5%85%88%E9%9C%80%E8%A6%81%E7%A1%AE%E4%BF%9D%20Windows%20%E5%8F%AF%E4%BB%A5%E8%AE%BF%E9%97%AE%20WSL2%EF%BC%8C%E6%8E%A5%E7%9D%80%E5%9C%A8%20Windows,%E9%98%B2%E7%81%AB%E5%A2%99%E5%85%A5%E7%AB%99%20%E8%A7%84%E5%88%99%EF%BC%8C%E5%B0%86%E8%AF%B7%E6%B1%82%E8%BD%AC%E5%8F%91%E5%88%B0%20WSL2%E3%80%82%20%E4%BB%A5%E4%B8%8B%E4%B8%BA%20Powershell%20%E5%91%BD%E4%BB%A4%EF%BC%8C%E9%9C%80%20%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90%20%E6%89%A7%E8%A1%8C%E3%80%82">Win10 与 WSL2 间的网络和文件互访 - LOGI</a></p></div><nav class="post-nav"><a class="post-nav-item post-nav-prev" href="/2022/01/05/Spring%E5%BC%82%E6%AD%A5%E6%89%A7%E8%A1%8C%E6%97%B6%E5%90%8C%E6%AD%A5%E4%B8%8A%E4%B8%8B%E6%96%87%E4%BF%A1%E6%81%AF/"><div class="nav-arrow">&lt;&nbsp;NEWER</div><span class="post-title">Spring异步执行时同步上下文信息</span> </a><a class="post-nav-item post-nav-next" href="/2022/01/05/linux%E4%BA%A4%E4%BA%92%E5%BC%8F%E8%84%9A%E6%9C%AC/"><div class="nav-arrow">OLDER&nbsp;&gt;</div><span class="post-title">linux交互式脚本</span></a></nav></main></div><footer class="footer"><small class="footer_copyright"><div id="bottom-inner">© 2021 Site by Chong Xu using <a target="_blank" rel="noopener" href="http://hexo.io">hexo blog framework</a>.<br><p>Theme is <a target="_blank" rel="noopener" href="https://github.com/dewjohn/hexo-theme-klise">Klise</a></p></div></small></footer><script src="/js/main.js"></script><script>window.FPConfig={delay:0,ignoreKeywords:[],maxRPS:3,hoverDelay:50}</script><script defer src="https://cdn.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js"></script></body></html>